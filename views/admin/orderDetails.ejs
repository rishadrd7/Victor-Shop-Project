<%- include('../layouts/adminHeader') %>

<style>
  .box {
  border: 1px solid #ccc;
  border-radius: 5px;
  padding: 50px;
  margin-bottom: 10px;
}

.custom-select{
  margin-top: -40px;
  height: 40%;
  width: 50%;
  padding: 15px;
  background-color: transparent;
  border: none;

}

/* Custom select dropdown */
.custom-select select {
    width: 70%;
    padding: 10px;
    border: 1px solid #000000;
    border-radius: 5px;
    background-color: #fff;
    font-size: 16px;
    color: #333;
    cursor: pointer;
}



</style>

<div class="main-panel">
  <div class="content-wrapper">

    <div class="page-header">
      <h3 class="page-title">Orders Tables</h3>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li  class="breadcrumb-item"><button><a href="/admin/orders">Back</a></li></button>
        </ol>
      </nav>
    </div>
    

    <div class="col-lg-12 grid-margin stretch-card">
      <div class="card">
        <div class="card-body">



        

        <div class="detail">
          <span class="box-title">Product Details</span>

          <div class="box">

              <div class="box-content">


                      <% deliveryAddress.products.forEach(product => { %>

                          <p>Product Name: <%= product.productId.name %></p>

                          <p>Offer Price: <%= product.productId.offerPrice %></p>
                          
                          <p>Quantity: <%= product.quantity %></p>

                          <!-- Add more product details as needed -->



              </div>
          </div>
      </div>

      <div class="detail">
        <span class="box-title">Order Status</span>
        <div class="box" style="height: 25px;">
            <div class="box-content">
                <div class="custom-select">
                  <select name="productStatus" onchange="updateOrderStatus('<%= product.id %>')" id="orderStatus<%= product._id %>">
                    <option value="Pending" <%= product.status === 'Pending' ? 'selected' : '' %>>Pending</option>
                    <option value="Shipped" <%= product.status === 'Shipped' ? 'selected' : '' %>>Shipped</option>
                    <option value="Delivery" <%= product.status === 'Delivery' ? 'selected' : '' %>>Delivery</option>
                    <option value="Cancelled" <%= product.status === 'Cancelled' ? 'selected' : '' %>>Cancelled</option>
                </select></td>
                </div>
            </div>
        </div>
    </div>
    
    <% }); %>
      

          <div class="detail">
            <span class="box-title">Order Details</span>
            <div class="box">
              <div class="box-content">
               
                  <p><%= deliveryAddress.orderUserDetails.name %></p>
                  <p> <%= deliveryAddress.orderUserDetails.phone %></p>
                  <p> <%= deliveryAddress.orderUserDetails.streetAddress %></p>
                  <p> <%= deliveryAddress.orderUserDetails.pincode %></p>
                  <p> <%= deliveryAddress.orderUserDetails.place %></p>
                  <p> <%= deliveryAddress.orderUserDetails.locality %></p>
                  <p> <%= deliveryAddress.orderUserDetails.landmark %></p>
                  <p> <%= deliveryAddress.orderUserDetails.country %></p>
                  <p> <%= deliveryAddress.orderUserDetails.alternatePhone %></p>

                  <!-- Add more product details as needed -->


              </div>
            </div>
          </div>

   

        </div>
      </div>
    </div>



  </div>
</div>

<%- include('../layouts/adminFooter') %>


<script>
      


  function updateOrderStatus(orderId) {
    console.log(orderId)
var selectElement = document.getElementById('orderStatus_' + orderId);
var newStatus = selectElement.value;
console.log(newStatus)

fetch('/orders/updateOrderStatus', {
method: 'POST',
headers: {
  'Content-Type': 'application/json'
},
body: JSON.stringify({ orderId: orderId, newStatus: newStatus })

})

.then(response => {


if (response.ok) {
  console.log('Order status updated successfully');
} else {
  console.error('Error updating order status:', response.statusText);
}
})
.catch(error => {
console.error('Error updating order status:', error);
});
}

</script>