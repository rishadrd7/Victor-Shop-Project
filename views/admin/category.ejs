<%- include('../layouts/adminHeader')  %>


        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title"> Basic Tables </h3>

              <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="addCategory">+Add Catagory</a></li>
                
                </ol>
              </nav>
            </div>
            <div class="row">
        


              <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                  
                   
                    </p>
                    <div class="table-responsive">
                      <table class="table table-dark">
                        <thead>
                          <tr>
                            <th>No</th>
                            <th>Category Name</th>
                            <th>Description</th>
                            <th>Action</th> 
                          </tr>
                        </thead>
                        <tbody>
                          <% locals?.categories?.forEach((category, index) => { %>
                            <tr>
                              <td><%= index + 1 %></td>
                              <td><%= category.name %></td>
                              <td><%= category.description %></td>
                              <td>
                                <a href="#" class="btn btn-primary edit-category" data-category-id="<%= category._id %>" data-category-name="<%= category.name %>" data-category-description="<%= category.description %>">Edit</a>

                               
                                <a href="/admin/categories/delete/<%= category._id %>" class="btn btn-danger">Delete</a>


                                <form id="toggleForm_<%= category._id %>" action="/admin/category/<%= category._id %>/toggle" method="post" style="display: inline;">
                                  <button id="toggleButton_<%= category._id %>" type="button" class="btn <%= category.listed ? 'btn-warning' : 'btn-success' %>">
                                    <%= category.listed ? 'Unlist' : 'List' %>
                                  </button>
                                  <input type="hidden" name="_method" value="PUT">
                                  <input type="hidden" name="listed" value="<%= !category.listed %>">
                                </form>
                              
                              </td>
                              
                              
                            </tr>
                          <% }); %>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>


            </div>
          </div>


          <!-- Edit Category Modal -->


       

          <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
          <script>
            $(document).ready(function() {
              $('button[id^="toggleButton_"]').click(function() {
                var categoryId = $(this).attr('id').replace('toggleButton_', '');
                $('#toggleForm_' + categoryId).submit();
              });
            });
          </script>
          
          <script>
            $(document).ready(function() {
              // Function to handle edit modal display
              $('.edit-category').click(function() {
                var categoryId = $(this).data('category-id');
                var categoryName = $(this).data('category-name');
                var categoryDescription = $(this).data('category-description');
                $('#editCategoryForm').attr('action', '/admin/categories/' + categoryId + '/edit');
                $('#editCategoryName').val(categoryName);
                $('#editCategoryDescription').val(categoryDescription);
                $('#editCategoryModal').modal('show');
              });
            });
          </script>
          
       

<%- include('../layouts/adminFooter')  %>
        